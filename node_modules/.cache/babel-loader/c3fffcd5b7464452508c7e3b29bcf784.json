{"ast":null,"code":"var _jsxFileName = \"/Users/martinraba/Desktop/training_app/src/training/current-training/current-training-tab/CurrentTrainingTab.js\";\nimport React, { useRef, useState, useEffect, useContext, useCallback } from 'react';\nimport './Current-training-tab.css';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport Button from '@material-ui/core/Button';\nimport { exercises } from '../../../Exercises';\nimport { AuthContext } from '../../../auth/AuthContext';\nimport { useHistory } from 'react-router';\nimport CurrentTrainingTimer from '../current-training-timer/Current-training-timer';\n\nconst CurrentTrainingTab = () => {\n  const [startExercise, setStartExercise] = useState(false);\n  const [progress, setProgress] = useState(0);\n  const [exercise, setExercise] = useState('');\n  const [loading, setLoading] = useState(false);\n  const interval = useRef(0);\n  const currentExercise = useRef('');\n  const {\n    uid\n  } = useContext(AuthContext);\n  const history = useHistory();\n\n  const handleExerciseChange = event => {\n    if (event.target.value !== 0) {\n      setExercise(event.target.value);\n    }\n\n    return;\n  };\n\n  const CloseChooseExercise = () => {\n    setStartExercise(false);\n  };\n\n  const OpenChoosedExercise = () => {\n    setStartExercise(true);\n  };\n\n  const sendData = useCallback(async status => {\n    clearInterval(interval.current);\n    setProgress(0);\n    setLoading(false);\n    let data = { ...currentExercise.current,\n      id: currentExercise.current.name,\n      duration: currentExercise.current.duration * (progress / 100),\n      calories: currentExercise.current.calories * (progress / 100),\n      date: new Date().toLocaleDateString().split(\".\"),\n      status: status,\n      exUserId: uid\n    };\n\n    try {\n      let response = await fetch('https://training-app-d460e.firebaseio.com/exercises.json', {\n        method: \"POST\",\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(data)\n      });\n      response.json();\n    } catch (err) {\n      console.log(err.message);\n    }\n  }, [progress, uid]);\n  useEffect(() => {\n    currentExercise.current = exercises.find(ex => ex.id === exercise);\n\n    if (currentExercise.current) {\n      let duration = currentExercise.current.duration / 100 * 1000;\n\n      if (loading) {\n        interval.current = setInterval(() => {\n          setProgress(prevProgress => prevProgress >= 100 ? 10 : prevProgress + 1);\n        }, duration);\n      }\n\n      if (progress >= 100) {\n        sendData('completed');\n      }\n\n      return () => clearInterval(interval.current);\n    }\n  }, [loading, progress, exercise, uid, sendData]);\n\n  const startTraining = () => {\n    setLoading(true);\n  };\n\n  const cancelTraining = () => {\n    sendData('cancelled');\n    history.push({\n      pathname: \"/empty\"\n    });\n    history.goBack();\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"selectEx\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    onClick: OpenChoosedExercise,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }\n  }, \"Open the select\"), /*#__PURE__*/React.createElement(FormControl, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(InputLabel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 11\n    }\n  }, \"Exercises\"), /*#__PURE__*/React.createElement(Select, {\n    disabled: loading,\n    open: startExercise,\n    onClose: CloseChooseExercise,\n    onOpen: OpenChoosedExercise,\n    value: exercise,\n    onChange: handleExerciseChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 11\n    }\n  }, exercises.map(ex => {\n    return /*#__PURE__*/React.createElement(MenuItem, {\n      key: ex.id,\n      value: ex.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 23\n      }\n    }, \" \", ex.id, \" \");\n  }))), /*#__PURE__*/React.createElement(CurrentTrainingTimer, {\n    exercise: exercise,\n    loading: loading,\n    progress: progress,\n    cancelTraining: cancelTraining,\n    startTraining: startTraining,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 9\n    }\n  }));\n};\n\nexport default CurrentTrainingTab;","map":{"version":3,"sources":["/Users/martinraba/Desktop/training_app/src/training/current-training/current-training-tab/CurrentTrainingTab.js"],"names":["React","useRef","useState","useEffect","useContext","useCallback","InputLabel","MenuItem","FormControl","Select","Button","exercises","AuthContext","useHistory","CurrentTrainingTimer","CurrentTrainingTab","startExercise","setStartExercise","progress","setProgress","exercise","setExercise","loading","setLoading","interval","currentExercise","uid","history","handleExerciseChange","event","target","value","CloseChooseExercise","OpenChoosedExercise","sendData","status","clearInterval","current","data","id","name","duration","calories","date","Date","toLocaleDateString","split","exUserId","response","fetch","method","headers","body","JSON","stringify","json","err","console","log","message","find","ex","setInterval","prevProgress","startTraining","cancelTraining","push","pathname","goBack","map"],"mappings":"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","sourcesContent":["import React, {useRef, useState, useEffect, useContext, useCallback} from 'react';\nimport './Current-training-tab.css';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport Button from '@material-ui/core/Button';\nimport { exercises } from '../../../Exercises';\nimport { AuthContext } from '../../../auth/AuthContext';\nimport { useHistory } from 'react-router';\nimport CurrentTrainingTimer from '../current-training-timer/Current-training-timer';\n\n\nconst CurrentTrainingTab = () => {\n\n\tconst [startExercise, setStartExercise] = useState(false);\n\tconst [progress, setProgress] = useState(0);\n\tconst [exercise, setExercise] = useState('');\n\tconst [loading, setLoading] = useState(false);\n\n\tconst interval = useRef(0);\n\tconst currentExercise = useRef('');\n\tconst { uid } = useContext(AuthContext);\n\tconst history = useHistory();\n\n\tconst handleExerciseChange = (event) => {\n\t\tif (event.target.value !== 0) {\n\t\t\tsetExercise(event.target.value);\n\t\t}\n\t\treturn;\n\t};\n\n\tconst CloseChooseExercise = () => {\n\t\tsetStartExercise(false);\n\t};\n\n\tconst OpenChoosedExercise = () => {\n\t\tsetStartExercise(true);\n\t};\n\n\tconst sendData = useCallback( async (status) => {\n\t\tclearInterval(interval.current);\n\t\tsetProgress(0);\n\t\tsetLoading(false);\n\n\t\tlet data = {\n\t\t\t...currentExercise.current,\n\t\t\tid: currentExercise.current.name,\n\t\t\tduration: currentExercise.current.duration * (progress / 100),\n\t\t\tcalories: currentExercise.current.calories * (progress / 100),\n\t\t\tdate: (new Date())\n\t\t\t\t.toLocaleDateString()\n\t\t\t\t.split(\".\"),\n\t\t\tstatus: status,\n\t\t\texUserId: uid\n\t\t};\n\t\ttry {\n\t\t\tlet response = await fetch(\n\t\t\t\t'https://training-app-d460e.firebaseio.com/exercises.json', {\n\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\t\tbody: JSON.stringify(data)\n\t\t\t\t})\n\t\t\tresponse.json();\n\t\t} catch (err) {\n\t\t\tconsole.log(err.message);\n\t\t}\n\t}, [progress, uid])\n\n\tuseEffect(() => {\n\t\tcurrentExercise.current = exercises.find(ex => ex.id === exercise);\n\t\tif (currentExercise.current) {\n\t\t\tlet duration = currentExercise.current.duration / 100 * 1000;\n\t\t\tif (loading) {\n\t\t\t\tinterval.current = setInterval(() => {\n\t\t\t\t\tsetProgress((prevProgress) => (prevProgress >= 100 ? 10 : prevProgress + 1))\n\t\t\t\t}, duration);\n\t\t\t}\n\t\t\tif (progress >= 100) {\t\t\n\t\t\t\tsendData('completed');\n\t\t\t}\n\t\t\treturn () => clearInterval(interval.current)\n\t\t}\n\n\t}, [loading, progress, exercise, uid, sendData]);\n\n\n\t\n\n\tconst startTraining = () => {\n\t\tsetLoading(true);\n\t}\n\n\tconst cancelTraining = () => {\n\t\tsendData('cancelled')\n\t\thistory.push({ pathname: \"/empty\" });\n\t\thistory.goBack();\n\t}\n\n\treturn (\n\t\t<div className=\"selectEx\">\n        <Button onClick={OpenChoosedExercise} >\n          Open the select\n        </Button>\n        <FormControl >\n          <InputLabel >Exercises</InputLabel>\n          <Select\n\t\t  \tdisabled={loading}\n\t\t\topen={startExercise}\n            onClose={CloseChooseExercise}\n            onOpen={OpenChoosedExercise}\n            value={exercise}\n            onChange={handleExerciseChange}>    \n            {exercises.map(ex => {\n              return  <MenuItem key={ex.id} value={ex.id} > {ex.id} </MenuItem>\n            })} \n          </Select>\n        </FormControl>\n        <CurrentTrainingTimer\n          exercise={exercise}\n          loading={loading}\n          progress={progress}\n          cancelTraining={cancelTraining}\n          startTraining={startTraining}\n        />\n    </div>\n\t);\n}\n\nexport default CurrentTrainingTab;"]},"metadata":{},"sourceType":"module"}